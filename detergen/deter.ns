set ns [new Simulator]
source tb_compat.tcl

tb-use-endnodeshaping 1
set n_nodes 11
set n_routers 11

for {set i 0} {$i < $n_nodes} {incr i} {
	set site($i) [$ns node]
	tb-set-hardware $site($i) {MicroCloud}
	tb-set-node-os $site($i) Ubuntu1404-64-STD
}
for {set i 0} {$i < $n_routers} {incr i} {
	set router($i) [$ns node]
	tb-set-hardware $router($i) {MicroCloud}
	tb-set-node-os $router($i) Ubuntu1404-64-STD
}

set link0 [$ns duplex-link $router(0) $router(3) 100Mb 170.300371ms DropTail]
tb-set-ip-link $router(0) $link0 10.1.1.2
tb-set-ip-link $router(3) $link0 10.1.1.3
set link1 [$ns duplex-link $router(0) $router(10) 100Mb 180.131853ms DropTail]
tb-set-ip-link $router(0) $link1 10.1.2.2
tb-set-ip-link $router(10) $link1 10.1.2.3
set link2 [$ns duplex-link $router(0) $router(6) 100Mb 46.140125ms DropTail]
tb-set-ip-link $router(0) $link2 10.1.3.2
tb-set-ip-link $router(6) $link2 10.1.3.3
set link3 [$ns duplex-link $router(0) $router(2) 100Mb 280.410617ms DropTail]
tb-set-ip-link $router(0) $link3 10.1.4.2
tb-set-ip-link $router(2) $link3 10.1.4.3
set link4 [$ns duplex-link $router(1) $router(5) 100Mb 165.744864ms DropTail]
tb-set-ip-link $router(1) $link4 10.1.5.2
tb-set-ip-link $router(5) $link4 10.1.5.3
set link5 [$ns duplex-link $router(1) $router(6) 100Mb 221.465114ms DropTail]
tb-set-ip-link $router(1) $link5 10.1.6.2
tb-set-ip-link $router(6) $link5 10.1.6.3
set link6 [$ns duplex-link $router(1) $router(10) 100Mb 87.443272ms DropTail]
tb-set-ip-link $router(1) $link6 10.1.7.2
tb-set-ip-link $router(10) $link6 10.1.7.3
set link7 [$ns duplex-link $router(1) $router(7) 100Mb 66.141501ms DropTail]
tb-set-ip-link $router(1) $link7 10.1.8.2
tb-set-ip-link $router(7) $link7 10.1.8.3
set link8 [$ns duplex-link $router(2) $router(10) 100Mb 100.285102ms DropTail]
tb-set-ip-link $router(2) $link8 10.1.9.2
tb-set-ip-link $router(10) $link8 10.1.9.3
set link9 [$ns duplex-link $router(2) $router(6) 100Mb 234.306863ms DropTail]
tb-set-ip-link $router(2) $link9 10.1.10.2
tb-set-ip-link $router(6) $link9 10.1.10.3
set link10 [$ns duplex-link $router(2) $router(5) 100Mb 152.903167ms DropTail]
tb-set-ip-link $router(2) $link10 10.1.11.2
tb-set-ip-link $router(5) $link10 10.1.11.3
set link11 [$ns duplex-link $router(3) $router(9) 100Mb 174.008793ms DropTail]
tb-set-ip-link $router(3) $link11 10.1.12.2
tb-set-ip-link $router(9) $link11 10.1.12.3
set link12 [$ns duplex-link $router(3) $router(10) 100Mb 9.842283ms DropTail]
tb-set-ip-link $router(3) $link12 10.1.13.2
tb-set-ip-link $router(10) $link12 10.1.13.3
set link13 [$ns duplex-link $router(3) $router(6) 100Mb 124.186210ms DropTail]
tb-set-ip-link $router(3) $link13 10.1.14.2
tb-set-ip-link $router(6) $link13 10.1.14.3
set link14 [$ns duplex-link $router(4) $router(7) 100Mb 42.671890ms DropTail]
tb-set-ip-link $router(4) $link14 10.1.15.2
tb-set-ip-link $router(7) $link14 10.1.15.3
set link15 [$ns duplex-link $router(4) $router(9) 100Mb 380.060142ms DropTail]
tb-set-ip-link $router(4) $link15 10.1.16.2
tb-set-ip-link $router(9) $link15 10.1.16.3
set link16 [$ns duplex-link $router(4) $router(5) 100Mb 56.962223ms DropTail]
tb-set-ip-link $router(4) $link16 10.1.17.2
tb-set-ip-link $router(5) $link16 10.1.17.3
set link17 [$ns duplex-link $router(4) $router(8) 100Mb 89.244074ms DropTail]
tb-set-ip-link $router(4) $link17 10.1.18.2
tb-set-ip-link $router(8) $link17 10.1.18.3
set link18 [$ns duplex-link $router(5) $router(7) 100Mb 99.624615ms DropTail]
tb-set-ip-link $router(5) $link18 10.1.19.2
tb-set-ip-link $router(7) $link18 10.1.19.3
set link19 [$ns duplex-link $router(7) $router(8) 100Mb 46.586404ms DropTail]
tb-set-ip-link $router(7) $link19 10.1.20.2
tb-set-ip-link $router(8) $link19 10.1.20.3
set link20 [$ns duplex-link $router(8) $router(9) 100Mb 290.829516ms DropTail]
tb-set-ip-link $router(8) $link20 10.1.21.2
tb-set-ip-link $router(9) $link20 10.1.21.3
set link21 [$ns duplex-link $router(0) $site(0) 100Mb 0ms DropTail]
tb-set-ip-link $router(0) $link21 10.1.22.2
tb-set-ip-link $site(0) $link21 10.1.22.3
set link22 [$ns duplex-link $router(1) $site(1) 100Mb 0ms DropTail]
tb-set-ip-link $router(1) $link22 10.1.23.2
tb-set-ip-link $site(1) $link22 10.1.23.3
set link23 [$ns duplex-link $router(2) $site(2) 100Mb 0ms DropTail]
tb-set-ip-link $router(2) $link23 10.1.24.2
tb-set-ip-link $site(2) $link23 10.1.24.3
set link24 [$ns duplex-link $router(3) $site(3) 100Mb 0ms DropTail]
tb-set-ip-link $router(3) $link24 10.1.25.2
tb-set-ip-link $site(3) $link24 10.1.25.3
set link25 [$ns duplex-link $router(4) $site(4) 100Mb 0ms DropTail]
tb-set-ip-link $router(4) $link25 10.1.26.2
tb-set-ip-link $site(4) $link25 10.1.26.3
set link26 [$ns duplex-link $router(5) $site(5) 100Mb 0ms DropTail]
tb-set-ip-link $router(5) $link26 10.1.27.2
tb-set-ip-link $site(5) $link26 10.1.27.3
set link27 [$ns duplex-link $router(6) $site(6) 100Mb 0ms DropTail]
tb-set-ip-link $router(6) $link27 10.1.28.2
tb-set-ip-link $site(6) $link27 10.1.28.3
set link28 [$ns duplex-link $router(7) $site(7) 100Mb 0ms DropTail]
tb-set-ip-link $router(7) $link28 10.1.29.2
tb-set-ip-link $site(7) $link28 10.1.29.3
set link29 [$ns duplex-link $router(8) $site(8) 100Mb 0ms DropTail]
tb-set-ip-link $router(8) $link29 10.1.30.2
tb-set-ip-link $site(8) $link29 10.1.30.3
set link30 [$ns duplex-link $router(9) $site(9) 100Mb 0ms DropTail]
tb-set-ip-link $router(9) $link30 10.1.31.2
tb-set-ip-link $site(9) $link30 10.1.31.3
set link31 [$ns duplex-link $router(10) $site(10) 100Mb 0ms DropTail]
tb-set-ip-link $router(10) $link31 10.1.32.2
tb-set-ip-link $site(10) $link31 10.1.32.3

$ns rtproto Manual

$ns run